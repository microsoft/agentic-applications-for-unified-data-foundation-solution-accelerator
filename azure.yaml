# # yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json
# metadata:
#     template: azd-init@1.11.1
environment:
  name: agentic-applications-for-unified-data-foundation
  location: eastus
name: agentic-applications-for-unified-data-foundation

requiredVersions:
  azd: ">= 1.15.0"

metadata:
  template: agentic-applications-for-unified-data-foundation@1.1

hooks:
  postprovision:
    windows:
      run: |
        Write-Host "Web app URL: "
        Write-Host "$env:WEB_APP_URL" -ForegroundColor Cyan

        Write-Host "`nRun the following commands in the bash terminal:"
        Write-Host "1. Create agents:"
        Write-Host "bash ./infra/scripts/agent_scripts/run_create_agents_scripts.sh" -ForegroundColor Cyan

        $isWorkshop = $env:IS_WORKSHOP
        if ($isWorkshop -eq "true") {
            Write-Host "`n2. Setup workshop data (SQL + Search Index):"
            Write-Host "bash ./infra/scripts/run_workshop_data_setup.sh" -ForegroundColor Cyan
        } else {
            Write-Host "`n2. Create Fabric items:"
            Write-Host "bash ./infra/scripts/fabric_scripts/run_fabric_items_scripts.sh <fabric_workspace_id>" -ForegroundColor Cyan
        }

      shell: pwsh
      continueOnError: false
      interactive: true
    posix:
      run: |
        echo "Web app URL: "
        echo $WEB_APP_URL
        echo ""
        echo "Run the following commands in the bash terminal:"
        echo "1. Create agents:"
        echo "bash ./infra/scripts/agent_scripts/run_create_agents_scripts.sh"

        if [ "$IS_WORKSHOP" = "true" ]; then
            echo ""
            echo "2. Setup workshop data (SQL + Search Index):"
            echo "bash ./infra/scripts/run_workshop_data_setup.sh"
        else
            echo ""
            echo "2. Create Fabric items:"
            echo "bash ./infra/scripts/fabric_scripts/run_fabric_items_scripts.sh <fabric_workspace_id>"
        fi

      shell: sh
      continueOnError: false
      interactive: true
